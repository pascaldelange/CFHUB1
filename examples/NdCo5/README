This directory contains all necessary input files for an ab initio calculation of crystal and exchange fields on the Nd 4f shell in the rare-earth intermetallic NdCo5. 

1. First, generate the non-spin-orbit input for Wien2k by 

> init_lapw -b -sp -numk 1000 -vxc 5

then set up additional input files for calculations with spin-orbit

>initso

and accept all default choices in the course of interactive initialization, until you are asked

>> Do you have a spinpolarized case (and want to run symmetso) ? (y/N)

here you reply 'y' as well as to the  following question

>> Do you have a spinpolarized case (and want to run symmetso) ? (y/N)

and then choose the default number of k-points (1000). You may also change the default mixing method in NdCo5.inm "MSR1" to "MSEC1", the later is usualy more stable.

2. Run initial DFT calculations with the spin polarization on Nd 4f suppressed. Such initial DFT run is recommended to obtain a reasonable starting charge density for DFT+HubI, though it is not always necessary.

One sets the parameter run_dmft in the script NdCo5.py to False and then execute usual DFT+DMFT cycle with Wien2k+TRIQS as

> runsp_triqs -so -qdmft 16 -i 10

for 10 initial iterations. -qdmft 16 specifies parallel calculations on 16 cores 

3. Once this initial DFT run is done one may start DFT+HubI calculations. Set run_dmft=True in NdCo5.py, remove NdCo5.h5 generated by initial run, and run DFT+HubI to convergence 

> runsp_triqs -so -qdmft 16 -ec 0.00001

these calculations require about 20 Wien2k iterations to converge. The resulting atomic eigenstates within the ground-state multiplet can be found in the file GS_MULTIPLET. 

In order to obtain the crystal-field parameters you copy the converged (last) matrix of non-interacting atomic levels from 'eal.dat' to the file 'atomic_level_matrix'. The crystal and exchange-field parameters are then extracted by executing the script fit_cf_par.py:

> python fit_cf_par.py

The obtained values can be compared with the benchmark values stored in 'resulting_CF_parameters' . Note that minute differences in CF parameters are normal, as they are sensitive to the degree of convergence of DFT+HubI.
